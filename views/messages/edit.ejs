<%- include('../partials/header') %>

<div class="container mt-4">
  <h1>Edit Message</h1>
  <form action="/messages/<%= message.id %>?_method=PUT" method="POST" class="mt-3">
    <div class="mb-3">
      <label class="form-label">Conversation</label>
      <select name="conversation_id" class="form-select" disabled>
        <% conversations.forEach(c => { %>
          <option value="<%= c.id %>" <%= c.id === message.conversation_id ? "selected" : "" %>>
            <%= c.title %>
          </option>
        <% }) %>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Sender</label>
      <select name="sender_id" class="form-select" disabled>
        <% users.forEach(u => { %>
          <option value="<%= u.id %>" <%= u.id === message.sender_id ? "selected" : "" %>>
            <%= u.name %>
          </option>
        <% }) %>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Message</label>
      <textarea name="message" class="form-control" rows="3" required><%= message.message %></textarea>
    </div>
    <div class="mb-3">
      <label class="form-label">Is Read?</label>
      <select name="is_read" class="form-select">
        <option value="0" <%= message.is_read ? "" : "selected" %>>No</option>
        <option value="1" <%= message.is_read ? "selected" : "" %>>Yes</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary">✅ Update</button>
    <a href="/messages" class="btn btn-secondary">⬅️ Back</a>
  </form>
</div>

<%- include('../partials/footer') %>
